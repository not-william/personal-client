(function(e){function t(t){for(var a,i,o=t[0],c=t[1],u=t[2],m=0,p=[];m<o.length;m++)i=o[m],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&p.push(n[i][0]),n[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);l&&l(t);while(p.length)p.shift()();return s.push.apply(s,u||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],a=!0,o=1;o<r.length;o++){var c=r[o];0!==n[c]&&(a=!1)}a&&(s.splice(t--,1),e=i(i.s=r[0]))}return e}var a={},n={app:0},s=[];function i(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=a,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(r,a,function(t){return e[t]}.bind(null,a));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var l=c;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"1c77":function(e,t,r){e.exports=r.p+"img/map-marker-alt-solid.2b7c48a7.svg"},"29d4":function(e,t,r){e.exports=r.p+"img/stopwatch.6311d5cc.svg"},"3b91":function(e,t,r){e.exports=r.p+"img/arrow-circle-right-solid.e7f07410.svg"},4360:function(e,t,r){"use strict";var a=r("2b0e"),n=r("2f62"),s=(r("96cf"),r("1da1")),i=r("bc3a"),o=r.n(i),c={namespaced:!0,state:{token:null,user:null},getters:{authenticated:function(e){return e.token&&e.user},user:function(e){return e.user}},mutations:{SET_TOKEN:function(e,t){e.token=t},SET_USER:function(e,t){e.user=t}},actions:{signIn:function(e,t){return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.dispatch,r.next=3,o.a.post("token/",t);case 3:return n=r.sent,r.abrupt("return",a("attempt",n.data.access));case 5:case"end":return r.stop()}}),r)})))()},attempt:function(e,t){return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=e.commit,n=e.state,t&&a("SET_TOKEN",t),n.token){r.next=4;break}return r.abrupt("return");case 4:return r.prev=4,r.next=7,o.a.get("users/me/");case 7:s=r.sent,a("SET_USER",s.data),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](4),a("SET_TOKEN",null),a("SET_USER",null);case 15:case"end":return r.stop()}}),r,null,[[4,11]])})))()},signOut:function(e){var t=e.commit;t("SET_TOKEN",null),t("SET_USER",null)}}};a["a"].use(n["a"]);t["a"]=new n["a"].Store({state:{},mutations:{},actions:{},modules:{auth:c}})},"45e2":function(e,t,r){e.exports=r.p+"img/times-circle-solid.bb7daa97.svg"},"4e31":function(e,t,r){"use strict";r("6825")},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("main",{staticClass:"md:container mx-auto"},[r("router-view")],1)])},s=[],i={components:{}},o=i,c=(r("4e31"),r("2877")),u=Object(c["a"])(o,n,s,!1,null,null,null),l=u.exports,m=r("8c4f"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"px-3"},[a("div",{staticClass:"m-5 mb-0 float-right"},[a("form",[e._m(0),a("input",{directives:[{name:"model",rawName:"v-model",value:e.searchString,expression:"searchString"}],staticClass:"p-2 pr-9 text-md inline",attrs:{type:"text",placeholder:'e.g. "wine" or "kyoto"',name:"search",id:"search"},domProps:{value:e.searchString},on:{keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;t.preventDefault()},input:function(t){t.target.composing||(e.searchString=t.target.value)}}}),e.searchString?a("a",{attrs:{href:"#"},on:{click:function(t){t.preventDefault(),e.searchString=""}}},[a("img",{staticClass:"h-5 inline opacity-60 mb-1 relative right-7 hover:opacity:80",attrs:{src:r("45e2")}})]):e._e()])]),a("div",{staticClass:"clear-both"}),e.images||e.fromRoute?e._e():a("app-timeline"),e.images?a("app-timeline-search",{attrs:{images:e.images,search:e.search}}):e._e()],1)},d=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("label",{attrs:{for:"search"}},[a("img",{staticClass:"h-5 inline opacity-60 mb-1 mr-2",attrs:{src:r("aaa8")}})])}],g=(r("ac1f"),r("841c"),r("96cf"),r("1da1")),h=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"grid grid-cols-1 md:grid-cols-2"},e._l(e.posts,(function(e){return r("app-post",{key:e.id,attrs:{post:e}})})),1)])},f=[],v=r("bc3a"),b=r.n(v),x=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("router-link",{staticClass:"p-3 transition duration-100 hover:bg-gray-200 text-black",attrs:{to:{name:"image-from-post",params:{postId:e.post.id,imageOrder:1}}}},[r("div",[e._v(e._s(e.post.text))]),r("div",{staticClass:"grid grid-cols-2 mt-2"},e._l(e.post.images,(function(t,a){return r("app-image",{key:t.id,attrs:{image:t,postId:e.post.id,imageOrder:a,gridSpan:e.gridSpan(a),borderRoundClassProp:e.borderClass(a)}})})),1)])},_=[],w=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:e.gridSpan},[r("router-link",{attrs:{to:e.imageTo}},[r("img",{staticClass:"object-cover h-full border border-grey-10 border-t-0 border-r-0 hover:opacity-80 transition duration-100",class:e.borderRoundClass,attrs:{src:e.srcPath}})])],1)},y=[],O=(r("a15b"),r("1276"),{computed:{srcPath:function(){var e=this.image.file.split("/");return e[e.length-1]="sm-"+e[e.length-1],e.join("/")},borderRoundClass:function(){if(this.borderRoundClassProp)return this.borderRoundClassProp;if(this.search)return"rounded-xl";switch(this.image.order){case 1:return"rounded-tl-xl";case 2:return"rounded-tr-xl";case 3:return"rounded-bl-xl";case 4:return"rounded-br-xl";default:return"rounded-xl"}},imageTo:function(){return this.postId?{name:"image-from-post",params:{postId:this.postId,imageOrder:this.image.order}}:{name:"image-from-search",params:{imageId:this.image.id}}}},props:{image:{required:!0,type:Object},postId:{required:!1},search:{required:!1,default:!1},gridSpan:{required:!1,default:""},borderRoundClassProp:{required:!1,default:!1}}}),S=O,C=Object(c["a"])(S,w,y,!1,null,null,null),k=C.exports,j={props:{post:{required:!0,type:Object}},components:{"app-image":k},methods:{gridSpan:function(e){return 3==this.post.images.length&&0==e||2==this.post.images.length?"row-span-2 h-80":1==this.post.images.length?"row-span-2 col-span-2 h-80":"h-40"},borderClass:function(e){if(3==this.post.images.length){if(0==e)return"rounded-tl-xl rounded-bl-xl";if(2==e)return"rounded-br-xl"}if(2==this.post.images.length){if(0==e)return"rounded-tl-xl rounded-bl-xl";if(1==e)return"rounded-tr-xl rounded-br-xl"}return 1==this.post.images.length&&"rounded-xl"}}},E=j,R=Object(c["a"])(E,x,_,!1,null,null,null),$=R.exports,I={data:function(){return{posts:[]}},methods:{getPosts:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.a.get("posts/");case 2:r=t.sent,e.posts=r.data.results;case 4:case"end":return t.stop()}}),t)})))()}},mounted:function(){this.getPosts()},components:{"app-post":$}},P=I,T=Object(c["a"])(P,h,f,!1,null,null,null),q=T.exports,z=r("2ef0"),N=r.n(z),D=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"p-5"},[r("div",{staticClass:"text-lg mb-2"},[e._v("Results for "),r("i",{staticClass:"ml-1"},[e._v(e._s(e.search))])]),e.images.length>0?r("div",{staticClass:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4"},e._l(e.images,(function(e){return r("app-image",{key:e.id,staticClass:"mr-1 mb-1",attrs:{image:e,search:!0}})})),1):e._e(),0==e.images.length?r("div",[e._v(" No results ")]):e._e()])},M=[],U={props:{images:{required:!0},search:{required:!0}},components:{"app-image":k}},K=U,B=Object(c["a"])(K,D,M,!1,null,null,null),H=B.exports,A={name:"home",components:{"app-timeline":q,"app-timeline-search":H},data:function(){return{search:null,searchString:null,images:null,fromRoute:!1}},watch:{searchString:function(){this.searchString.length>0?this.waitSearch():(this.images=null,this.$router.push({name:"home"}))}},methods:{waitSearch:N.a.debounce(Object(g["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.fromRoute){e.next=3;break}return this.fromRoute=!1,e.abrupt("return");case 3:this.search=this.searchString,this.$router.push({name:"search",params:{search:this.search}}),this.searchImages();case 6:case"end":return e.stop()}}),e,this)}))),500),searchImages:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.a.get("images?search="+e.search);case 2:r=t.sent,e.searchString.length>0&&(e.images=r.data.results);case 4:case"end":return t.stop()}}),t)})))()}},beforeMount:function(){this.$route.params.search&&(console.log("before mount"),this.fromRoute=!0,this.searchString=this.$route.params.search,this.search=this.$route.params.search,this.searchImages())}},J=A,L=Object(c["a"])(J,p,d,!1,null,null,null),F=L.exports,G=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("form",{on:{submit:function(t){return t.preventDefault(),e.submit(t)}}},[r("div",[r("label",{attrs:{for:"username"}},[e._v(" Username ")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.username,expression:"form.username"}],attrs:{type:"text",name:"username",id:"username"},domProps:{value:e.form.username},on:{input:function(t){t.target.composing||e.$set(e.form,"username",t.target.value)}}})]),r("div",[r("label",{attrs:{for:"password"}},[e._v(" Password ")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.password,expression:"form.password"}],attrs:{type:"password",name:"password",id:"password"},domProps:{value:e.form.password},on:{input:function(t){t.target.composing||e.$set(e.form,"password",t.target.value)}}})]),e._m(0)])},Q=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("button",{attrs:{type:"submit"}},[e._v(" Sign in ")])])}],V=(r("5319"),r("5530")),W=r("2f62"),X={name:"signin",components:{},data:function(){return{form:{username:"",password:""}}},methods:Object(V["a"])(Object(V["a"])({},Object(W["b"])({signIn:"auth/signIn"})),{},{submit:function(){var e=this;this.signIn(this.form).then((function(){e.$router.replace({name:"dashboard"})})).catch((function(){console.log("failed")}))}})},Y=X,Z=Object(c["a"])(Y,G,Q,!1,null,null,null),ee=Z.exports,te=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("form",{attrs:{action:"#"},on:{click:function(e){e.preventDefault()}}})])},re=[],ae={name:"upload",components:{}},ne=ae,se=Object(c["a"])(ne,te,re,!1,null,null,null),ie=se.exports,oe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("app-image-modal",{attrs:{image:e.post.images[e.imageOrder-1],text:e.post.text}}),e.imageOrder>1?a("a",{staticClass:"fixed left-0 z-50 top-1/2 ml-2 opacity-60 hover:opacity-100",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.incrementOrder(-1)}}},[a("img",{staticClass:"w-10",attrs:{src:r("7c41")}})]):e._e(),e.imageOrder<e.post.images.length?a("a",{staticClass:"fixed right-0 z-50 top-1/2 mr-2 opacity-60 hover:opacity-100",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.incrementOrder(1)}}},[a("img",{staticClass:"w-10",attrs:{src:r("3b91")}})]):e._e(),a("a",{staticClass:"fixed left-0 z-50 top-0 ml-2 mt-2 opacity-60 hover:opacity-100",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.showTimeline()}}},[a("img",{staticClass:"w-10",attrs:{src:r("45e2")}})])],1)},ce=[],ue=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fixed inset-0 bg-gray-600 flex"},[a("div",{staticClass:"mx-auto flex flex-wrap"},[a("img",{staticClass:"max-h-screen inline object-contain",staticStyle:{"margin-bottom":"10000px"},attrs:{src:e.srcPath,id:"image"}}),a("div",{staticClass:"bg-white inline p-6 mt-3 ml-3 w-64",staticStyle:{height:"max-content"}},[e.text?a("div",{staticClass:"mb-4 text-lg"},[e._v(" "+e._s(e.text)+" ")]):e._e(),e.image.location?a("div",{staticClass:"flex mb-4 text-gray-800"},[a("img",{staticClass:"h-5 mr-2 opacity-80",staticStyle:{"margin-top":"2px"},attrs:{src:r("1c77")}}),e._v(" "+e._s(e.image.location)+" ")]):e._e(),e.image.f_number?a("div",{staticClass:"flex mb-2 text-gray-600 text-sm"},[a("img",{staticClass:"h-4 mr-2 opacity-80",staticStyle:{"margin-top":"2px"},attrs:{src:r("8db1")}}),e._v(" f/"+e._s(e.image.f_number)+" ")]):e._e(),e.image.shutter_speed?a("div",{staticClass:"flex mb-2 text-gray-600 text-sm"},[a("img",{staticClass:"h-4 mr-2 opacity-80",staticStyle:{"margin-top":"2px"},attrs:{src:r("29d4")}}),e._v(" 1/"+e._s(e.image.shutter_speed)+"s ")]):e._e(),e.image.focal_length?a("div",{staticClass:"flex mb-2 text-gray-600 text-sm"},[a("img",{staticClass:"h-4 mr-2 opacity-80",staticStyle:{"margin-top":"2px"},attrs:{src:r("ac6f")}}),e._v(" "+e._s(e.image.focal_length)+"mm ")]):e._e()])])])},le=[],me={data:function(){return{}},computed:{srcPath:function(){var e=this.image.file.split("/");return e[e.length-1]="lg-"+e[e.length-1],e.join("/")}},props:{image:{required:!0,type:Object},text:{required:!1},search:{required:!1,default:!1}},methods:{imResize:function(){var e=this.imageObj.clientHeight,t=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0),r=(t-e)/2;this.imageObj.style.marginTop=String(r)+"px"}},mounted:function(){this.imageObj=document.getElementById("image"),setInterval(this.imResize,10),window.onresize=this.imResize}},pe=me,de=Object(c["a"])(pe,ue,le,!1,null,null,null),ge=de.exports,he={name:"image-from-post",components:{"app-image-modal":ge},data:function(){return{post:null,imageOrder:null}},methods:{getPost:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.a.get("posts/".concat(e.$route.params.postId));case 2:r=t.sent,e.post=r.data;case 4:case"end":return t.stop()}}),t)})))()},incrementOrder:function(e){1==this.imageOrder&&-1==e||this.imageOrder==this.post.images.length+1&&1==e||(this.imageOrder+=e,this.$router.push({name:"image-from-post",params:{postId:this.post.id,imageOrder:this.imageOrder}}))},showTimeline:function(){this.$router.push({name:"home"})}},watch:{post:function(){var e=[];e[this.imageOrder]=new Image,e[this.imageOrder].src=this.post.images[this.imageOrder-1].file;for(var t=0;t<this.post.images.length;t++)t!=this.imageOrder-1&&(e[t]=new Image,e[t].src=this.post.images[t].file)}},mounted:function(){this.imageOrder=parseInt(this.$route.params.imageOrder),this.getPost()}},fe=he,ve=Object(c["a"])(fe,oe,ce,!1,null,null,null),be=ve.exports,xe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("app-image-modal",{attrs:{image:e.image,text:e.image.post}}),a("a",{staticClass:"fixed left-0 z-50 top-0 ml-2 mt-2 opacity-60 hover:opacity-100",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.goBack()}}},[a("img",{staticClass:"w-10",attrs:{src:r("45e2")}})])],1)},_e=[],we={name:"image-from-search",components:{"app-image-modal":ge},data:function(){return{image:null}},methods:{goBack:function(){this.$router.go(-1)}},mounted:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.a.get("images/"+e.$route.params["imageId"]);case 2:r=t.sent,e.image=r.data;case 4:case"end":return t.stop()}}),t)})))()}},ye=we,Oe=Object(c["a"])(ye,xe,_e,!1,null,null,null),Se=Oe.exports,Ce=r("4360");a["a"].use(m["a"]);var ke=[{path:"/",name:"home",component:F},{path:"/search/:search",name:"search",component:F},{path:"/post/:postId/image/:imageOrder",name:"image-from-post",component:be},{path:"/image/:imageId",name:"image-from-search",component:Se},{path:"/signin",name:"signin",component:ee},{path:"/upload",name:"upload",component:ie,beforeEnter:function(e,t,r){Ce["a"].getters["auth/authenticated"]||(console.log("Not signed in"),r({name:"signin"})),r()}}],je=new m["a"]({mode:"history",base:"/",routes:ke}),Ee=je;r("8a71");r("66c6"),b.a.defaults.baseURL="http://notwilli.am:8000/api/",a["a"].config.productionTip=!1,Ce["a"].dispatch("auth/attempt",localStorage.getItem("token")).then(new a["a"]({router:Ee,store:Ce["a"],render:function(e){return e(l)}}).$mount("#app"))},"66c6":function(e,t,r){"use strict";r.r(t);var a=r("4360"),n=r("bc3a"),s=r.n(n);a["a"].subscribe((function(e){switch(e.type){case"auth/SET_TOKEN":e.payload?(s.a.defaults.headers.common["Authorization"]="Bearer ".concat(e.payload),localStorage.setItem("token",e.payload)):(s.a.defaults.headers.common["Authorization"]=null,localStorage.removeItem("token"));break}}))},6825:function(e,t,r){},"7c41":function(e,t,r){e.exports=r.p+"img/arrow-circle-left-solid.22995d31.svg"},"8a71":function(e,t,r){},"8db1":function(e,t,r){e.exports=r.p+"img/aperture.d6f41d8e.svg"},aaa8:function(e,t,r){e.exports=r.p+"img/search-solid.c6a0effb.svg"},ac6f:function(e,t,r){e.exports=r.p+"img/camera-lens.541de8b6.svg"}});
//# sourceMappingURL=app.98328ecf.js.map